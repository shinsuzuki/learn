import numpy as np
import pandas as pd


def main():
    print("> start pandas ğŸš€")
    # ========================================

    # # ä¸€æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿
    # print(">> ä¸€æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿")
    # ser = pd.Series([10, 20, 30])
    # print(ser)

    # # 2æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿
    # print(">> 2æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿")
    # pd_df = pd.DataFrame(
    #     [
    #         [10, "a", True],
    #         [20, "b", False],
    #         [30, "c", True],
    #         [40, "d", True],
    #     ]
    # )
    # print(pd_df)

    # # DataFrameã®æ¦‚è¦
    # print(">> DataFrameã®æ¦‚è¦")
    # np_df = pd.DataFrame(np.arange(100).reshape(25, 4))
    # print(np_df)

    # print(">> DataFrameã®å…ˆé ­ã®5è¡Œ")
    # print(np_df.head())

    # print(">> DataFrameã®æœ«å°¾ã®5è¡Œ")
    # print(np_df.tail())

    # print(">> DataFrameã®ã‚µã‚¤ã‚º")
    # print(np_df.shape)

    # # ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åã€ã‚«ãƒ©ãƒ å
    # print(">> ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åã€ã‚«ãƒ©ãƒ å")
    # df = pd.DataFrame(np.arange(6).reshape((3, 2)))
    # df.index = ["01", "02", "03"]
    # df.columns = ["A", "B"]
    # print(df)

    # # dictã‹ã‚‰DataFrameã‚’ä½œæˆ
    # print(">> dictã‹ã‚‰DataFrameã‚’ä½œæˆ")
    # df = pd.DataFrame({"Aåˆ—": [1, 2, 3], "Båˆ—": [2, 3, 4]})
    # print(df)

    #
    print("========== ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ")
    print("==== Series")
    s1 = pd.Series([1, 3, 5, np.nan, 6, 8])
    print(s1)
    # 0    1.0
    # 1    3.0
    # 2    5.0
    # 3    NaN
    # 4    6.0
    # 5    8.0
    # dtype: float64

    print("==== dates")
    dates = pd.date_range("20250101", periods=6)
    print(dates)
    # DatetimeIndex(['2025-01-01', '2025-01-02', '2025-01-03', '2025-01-04', '2025-01-05', '2025-01-06'], dtype='datetime64[ns]', freq='D')

    print("==== DataFrame")
    d1 = pd.DataFrame(np.random.randn(6, 4), index=dates, columns=list("ABCD"))
    print(d1)
    #                    A         B         C         D
    # 2025-01-01 -0.099001 -0.172826  0.003649  0.147418
    # 2025-01-02 -2.799922  1.096627  0.605981  0.243630
    # 2025-01-03  0.890434  0.191426  0.350208  0.178634
    # 2025-01-04 -0.819983 -1.361846 -0.850104 -1.263281
    # 2025-01-05  0.314952  0.457265  0.361976 -0.973361
    # 2025-01-06 -0.312489  0.098288 -0.749593 -0.039706

    print("========== ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª")
    print("==== head")
    print(d1.head(n=2))
    #                    A         B         C         D
    # 2025-01-01 -0.099001 -0.172826  0.003649  0.147418
    # 2025-01-02 -2.799922  1.096627  0.605981  0.243630

    print("==== tail")
    print(d1.tail(n=2))
    #                    A         B         C         D
    # 2025-01-05  0.314952  0.457265  0.361976 -0.973361
    # 2025-01-06 -0.312489  0.098288 -0.749593 -0.039706

    print("==== index")
    print(d1.index)
    # DatetimeIndex(['2025-01-01', '2025-01-02', '2025-01-03', '2025-01-04',
    #                '2025-01-05', '2025-01-06'],
    #               dtype='datetime64[ns]', freq='D')

    print("==== columns")
    print(d1.columns)
    # Index(['A', 'B', 'C', 'D'], dtype='object')

    print("==== NumPyã®äºŒæ¬¡å…ƒé…åˆ—å½¢å¼ã«å¤‰æ›ã—ã¦ç¢ºèª,ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€ã‚«ãƒ©ãƒ ã¯ç„¡ã—")
    np_array = d1.to_numpy()
    print(np_array)
    print(f"[2, 3]: {np_array[2, 3]}")

    print("==== çµ±è¨ˆé‡ã®ç¢ºèªã€æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã‚«ãƒ©ãƒ ã«å¯¾ã—ã¦ã€å€‹æ•°ãƒ»å¹³å‡ãƒ»æ¨™æº–åå·®ãƒ»å„ç¨®ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«å€¤ã‚’ç¢ºèªã§ãã‚‹")
    print(d1.describe())
    #               A         B         C         D
    # count  6.000000  6.000000  6.000000  6.000000
    # mean  -0.471002  0.051489 -0.046314 -0.284444
    # std    1.279093  0.815668  0.615239  0.659156
    # min   -2.799922 -1.361846 -0.850104 -1.263281
    # 25%   -0.693109 -0.105048 -0.561282 -0.739947
    # 50%   -0.205745  0.144857  0.176928  0.053856
    # 75%    0.211464  0.390805  0.359034  0.170830
    # max    0.890434  1.096627  0.605981  0.243630

    print("==== ä¸¦ã³æ›¿ãˆ")
    # DataFrame.sort_index or sort_values
    print(d1.sort_values(by="C", ascending=False))
    #                    A         B         C         D
    # 2025-01-02 -2.799922  1.096627  0.605981  0.243630
    # 2025-01-05  0.314952  0.457265  0.361976 -0.973361
    # 2025-01-03  0.890434  0.191426  0.350208  0.178634
    # 2025-01-01 -0.099001 -0.172826  0.003649  0.147418
    # 2025-01-06 -0.312489  0.098288 -0.749593 -0.039706
    # 2025-01-04 -0.819983 -1.361846 -0.850104 -1.263281

    # https://gochikika.ntt.com/Features/pandas-usage.html

    print("========== ãƒ‡ãƒ¼ã‚¿ã®å–å¾—")
    print("==== ã‚«ãƒ©ãƒ ã§å–å¾—")
    print(d1["A"])
    # 2025-01-01    1.153927
    # 2025-01-02   -1.605941
    # 2025-01-03   -1.154231
    # 2025-01-04    0.949150
    # 2025-01-05   -1.619367
    # 2025-01-06   -0.031444

    print("==== ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ç¯„å›²ã§å–å¾—")
    print(d1["2025-01-02":"2025-01-04"])
    #                    A         B         C         D
    # 2025-01-02 -1.579745  1.078579  1.282452 -0.203428
    # 2025-01-03  0.448469 -1.061994 -0.565190 -0.565915
    # 2025-01-04 -0.380677 -0.462442  0.534128  1.036761

    print("==== æŒ‡å®šã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€ã‚«ãƒ©ãƒ ã®ç¯„å›²ã§å–å¾—1")
    print(d1.loc[:, ["A", "B"]])
    #                    A         B
    # 2025-01-01 -1.447462  1.589031
    # 2025-01-02 -0.374776  1.398718
    # 2025-01-03 -1.331007 -1.623943
    # 2025-01-04  1.805093 -1.157695
    # 2025-01-05 -0.562321  0.239569
    # 2025-01-06  1.113448  0.881306

    print("==== æŒ‡å®šã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€ã‚«ãƒ©ãƒ ã®ç¯„å›²ã§å–å¾—2")
    print(d1.loc["20250102":"20250104", ["A", "B", "C"]])
    #                    A         B         C
    # 2025-01-02 -0.374776  1.398718  0.440018
    # 2025-01-03 -1.331007 -1.623943  0.116794
    # 2025-01-04  1.805093 -1.157695 -1.348293

    print("==== æŒ‡å®šã®è¡Œãƒ»åˆ—ã®å–å¾—")
    print(d1.iloc[3:5, 0:2])
    #                    A         B
    # 2025-01-04  1.120167  0.866342
    # 2025-01-05  1.143607  0.268288

    print("==== æŒ‡å®šã®ã‚«ãƒ©ãƒ ã«å¯¾ã™ã‚‹Boolearnã®å–å¾—")
    print(d1["A"] > 0)
    # 2025-01-01  True
    # 2025-01-02  True
    # 2025-01-03  False
    # 2025-01-04  True
    # 2025-01-05  True
    # 2025-01-05  False

    print(d1[d1["A"] > 0])
    #                        A         B         C         D
    # 2025-01-01  0.011220 -0.728044 -0.385526 -1.364035
    # 2025-01-02  0.598690 -0.384468 -2.136119  1.777689
    # 2025-01-04  0.853191 -0.950380 -0.060094  0.760572
    # 2025-01-05  0.947519  0.913334  0.540093  0.202850

    print("==== åˆ—ã®è¿½åŠ ")
    d2 = d1.copy()
    d2["F"] = "999"
    print(d2)
    #                   A         B         C         D    F
    # 2025-01-01 -2.159206 -0.062891  0.394297  0.353924  999
    # 2025-01-02 -0.689309  0.496989  1.972858 -0.685082  999
    # 2025-01-03  0.592576  1.647718  0.560905  1.190000  999
    # 2025-01-04 -0.293059 -0.641923  1.081829 -1.332511  999
    # 2025-01-05 -0.023954  1.273115 -0.137211 -0.784827  999
    # 2025-01-06  0.921972 -1.284343  0.104228 -0.679156  999

    print("==== åˆ—ã®ç½®æ›")
    d2["F"] = "-1"
    print(d2)
    #                    A         B         C         D   F
    # 2025-01-01 -2.159206 -0.062891  0.394297  0.353924  -1
    # 2025-01-02 -0.689309  0.496989  1.972858 -0.685082  -1
    # 2025-01-03  0.592576  1.647718  0.560905  1.190000  -1
    # 2025-01-04 -0.293059 -0.641923  1.081829 -1.332511  -1
    # 2025-01-05 -0.023954  1.273115 -0.137211 -0.784827  -1
    # 2025-01-06  0.921972 -1.284343  0.104228 -0.679156  -1

    # https://gochikika.ntt.com/Features/pandas-usage.html

    print("========== æ¬ æãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†")
    print("========== ãƒ‡ãƒ¼ã‚¿ã®æ“ä½œ")
    print("========== ãƒ‡ãƒ¼ã‚¿ã®çµåˆ")
    print("========== ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°")
    print("========== æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†")
    print("========== ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–")
    print("========== ãƒ‡ãƒ¼ã‚¿ã®æ›¸ãå‡ºã—ãƒ»èª­ã¿è¾¼ã¿")
    print("========== DBã¨ã®RW")

    # ========================================
    print("< end pandas âœ¨ï¸")


if __name__ == "__main__":
    main()
